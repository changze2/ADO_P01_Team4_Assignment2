models:
  - name: final_circuit
    description: "Final circuit analysis table combining race, circuit, and results data."
    columns:
      - name: RACEID
        description: "Unique identifier for each race"
        tests:
          - not_null
          - relationships:
              to: ref('transf_races')  # Ensuring RACEID exists in the stg_races table
              field: RACEID

      - name: CIRCUIT_ID
        description: "Unique identifier for each circuit"
        tests:
          - not_null
          - relationships:
              to: ref('stg_circuits')  # Ensuring CIRCUIT_ID exists in the stg_circuits table
              field: CIRCUIT_ID

      - name: RESULTID
        description: "Results's unique identifier"
        tests:
          - not_null
          - unique
          - relationships:
              to: ref('stg_results')  # Ensure DRIVERID exists in the stg_drivers table
              field: RESULTID